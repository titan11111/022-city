<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>å¸‚é•·ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ï¼šå®Œå…¨ç‰ˆ</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=DotGothic16&display=swap');

        :root {
            --bg-color: #2c3e50;
            --container-bg: #34495e;
            --text-color: #ecf0f1;
            --accent-color: #3498db;
            --border-color: #ecf0f1;
            --shadow-color: #1a252f;
        }

        /* å…¨ä½“ã®ãƒœãƒƒã‚¯ã‚¹ã‚µã‚¤ã‚ºèª¿æ•´ã¨ã‚¿ãƒƒãƒæ“ä½œã®æœ€é©åŒ– */
        * { box-sizing: border-box; touch-action: manipulation; }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'DotGothic16', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            /* iOS Safariã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼å¯¾ç­– */
            min-height: -webkit-fill-available;
            margin: 0;
            overflow: hidden;
            padding: 10px;
        }

        .game-container {
            background-color: var(--container-bg);
            border: 4px solid var(--border-color);
            padding: 15px;
            width: 100%;
            max-width: 600px;
            height: 95vh; /* ã‚¹ãƒãƒ›ç”»é¢ã«åã¾ã‚‹ã‚ˆã†ã« */
            max-height: 800px;
            box-shadow: 8px 8px 0px var(--shadow-color);
            position: relative;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        /* --- ã‚¹ã‚¿ãƒ¼ãƒˆç”»é¢ï¼ˆéŸ³å£°å†ç”Ÿåˆ¶é™è§£é™¤ç”¨ï¼‰ --- */
        .start-overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(44, 62, 80, 0.98);
            z-index: 300;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            text-align: center;
            color: white;
        }
        
        .start-btn {
            background: #e74c3c;
            color: #fff;
            border: none;
            padding: 20px 40px;
            font-size: 1.5rem;
            font-family: 'DotGothic16', sans-serif;
            border-radius: 50px;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.4);
            cursor: pointer;
            margin-top: 20px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* --- ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒ†ã‚£ãƒƒã‚«ãƒ¼ --- */
        .news-ticker-container {
            background-color: #000;
            color: #f1c40f;
            padding: 5px 0;
            border: 2px solid #f39c12;
            overflow: hidden;
            font-size: 14px;
            white-space: nowrap;
            flex-shrink: 0;
        }
        .news-ticker-content {
            display: inline-block;
            padding-left: 100%;
            animation: ticker 15s linear infinite;
        }
        @keyframes ticker {
            0% { transform: translate3d(0, 0, 0); }
            100% { transform: translate3d(-100%, 0, 0); }
        }

        /* --- ãƒ˜ãƒƒãƒ€ãƒ¼ --- */
        header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 2px dashed var(--border-color);
            padding-bottom: 10px;
            flex-shrink: 0;
        }
        
        .header-left { display: flex; align-items: center; gap: 10px; }
        
        .mayor-icon {
            width: 40px; height: 40px;
            border: 2px solid #fff; border-radius: 50%;
            background-color: #000;
            object-fit: cover;
        }

        h1 { margin: 0; font-size: 1.2rem; letter-spacing: 1px; }

        .turn-badge {
            background-color: #e67e22;
            color: #fff;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 0.9rem;
            white-space: nowrap;
        }

        /* --- BGMåˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ --- */
        .bgm-btn {
            background: none; border: none; font-size: 1.5rem; cursor: pointer;
            position: absolute; top: 10px; right: 10px; z-index: 20;
        }

        /* --- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼ --- */
        .status-bar {
            display: flex;
            justify-content: space-between;
            background: #222;
            padding: 8px;
            border: 2px solid #7f8c8d;
            flex-shrink: 0;
        }
        .stat-box { text-align: center; flex: 1; border-right: 1px solid #444; }
        .stat-box:last-child { border-right: none; }
        .stat-label { font-size: 0.7em; color: #aaa; margin-bottom: 2px; }
        .stat-value { font-size: 1.2em; font-weight: bold; color: #fff; }

        /* --- ãƒ­ã‚°ç”»é¢ --- */
        .screen {
            background-color: #000;
            color: #2ecc71;
            padding: 10px;
            flex: 1; /* æ®‹ã‚Šã®ã‚¹ãƒšãƒ¼ã‚¹ã‚’åŸ‹ã‚ã‚‹ */
            overflow-y: auto;
            border: 4px inset #95a5a6;
            font-size: 0.9rem;
            line-height: 1.6;
            font-family: 'Courier New', monospace;
            -webkit-overflow-scrolling: touch; /* iOSã§ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«æ…£æ€§ */
        }
        .screen p { margin: 4px 0; border-bottom: 1px solid #111; }
        .screen p::before { content: "> "; color: #27ae60; }

        /* --- æ“ä½œãƒœã‚¿ãƒ³ --- */
        .controls {
            display: grid;
            grid-template-columns: 1fr;
            gap: 8px;
            flex-shrink: 0;
            padding-bottom: 5px;
        }
        button.choice-btn {
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-bottom: 4px solid #2980b9;
            padding: 15px 10px; /* ã‚¹ãƒãƒ›ã§æŠ¼ã—ã‚„ã™ã„é«˜ã• */
            font-family: 'DotGothic16', sans-serif;
            font-size: 1rem;
            cursor: pointer;
            text-align: left;
            border-radius: 4px;
            line-height: 1.3;
        }
        button.choice-btn:active {
            border-bottom: 2px solid #2980b9;
            transform: translateY(2px);
            margin-bottom: 2px;
        }
        .btn-subtext {
            font-size: 0.8em; color: #dbeeff; float: right; opacity: 0.9; margin-left: 5px;
        }

        /* --- SNSç”»é¢ --- */
        .overlay {
            display: none;
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 100;
            justify-content: center; align-items: center;
            backdrop-filter: blur(2px);
            padding: 15px;
        }
        .sns-window {
            background-color: #fff; color: #333;
            width: 100%; height: 100%;
            max-height: 500px;
            border-radius: 12px;
            overflow: hidden;
            border: 4px solid #3498db;
            display: flex; flex-direction: column;
        }
        .sns-header {
            background-color: #3498db; color: white; padding: 10px;
            text-align: center; font-weight: bold; flex-shrink: 0;
        }
        .sns-feed {
            padding: 10px; background-color: #f0f2f5; overflow-y: auto; flex: 1;
        }
        .tweet {
            background: white; padding: 10px; margin-bottom: 10px;
            border-radius: 8px; border: 1px solid #ddd; display: flex; gap: 10px;
        }
        .avatar {
            width: 40px; height: 40px; min-width: 40px;
            background-color: #ecf0f1; border-radius: 50%;
            display: flex; justify-content: center; align-items: center; font-size: 20px;
        }
        .tweet-content { flex: 1; }
        .user-name { font-weight: bold; font-size: 0.9em; margin-bottom: 2px; }
        .tweet-text { font-size: 0.9em; line-height: 1.4; }
        .likes { color: #e74c3c; font-size: 0.8em; margin-top: 5px; text-align: right; font-weight: bold; }
        .sns-close-btn {
            width: 100%; background-color: #2ecc71; color: white; border: none;
            border-bottom: 5px solid #27ae60; padding: 15px;
            font-family: 'DotGothic16', sans-serif; font-size: 1.1em;
            cursor: pointer; flex-shrink: 0;
        }

        /* --- ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚° --- */
        .ending-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); z-index: 200;
            justify-content: center; align-items: center;
            flex-direction: column; text-align: center; padding: 20px;
        }
        .ending-content {
            background: #fff; color: #333; padding: 30px 20px;
            border: 6px solid #f1c40f; width: 100%; max-width: 500px;
            box-shadow: 0 0 30px #f1c40f; border-radius: 8px;
        }
        .ending-title { font-size: 2em; margin-bottom: 15px; color: #d35400; font-weight: bold; }
        .restart-btn {
            margin-top:20px; padding:15px 30px; background:#e74c3c;
            color:white; border:none; font-size:1.1em; cursor:pointer;
            width: 100%; border-radius: 4px;
        }

        /* ã‚¹ãƒãƒ›ç”¨å¾®èª¿æ•´ */
        @media (max-width: 480px) {
            .game-container { border: none; height: 100vh; padding: 10px; }
            h1 { font-size: 1rem; }
            .btn-subtext { display: block; float: none; margin-top: 3px; font-size: 0.75em; }
        }
    </style>
</head>
<body>

<div class="game-container">
    <div class="start-overlay" id="start-overlay">
        <h1 style="font-size: 2em; margin-bottom: 10px;">å¸‚é•·ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</h1>
        <p style="opacity: 0.8; font-size: 0.9em;">ã‚µã‚¦ãƒ³ãƒ‰ã‚ã‚Š</p>
        <button class="start-btn" onclick="startGameWithAudio()">TAP TO START</button>
    </div>

    <div class="news-ticker-container">
        <div class="news-ticker-content" id="news-ticker">BREAKING NEWS: æ–°å¸‚é•·ãŒå°±ä»»ã€ä»Šå¾Œã®éƒ½å¸‚è¨ˆç”»ã«æ³¨ç›®ãŒé›†ã¾ã£ã¦ã„ã¾ã™...</div>
    </div>

    <header>
        <div class="header-left">
            <img src="images/character.png" alt="å¸‚é•·" class="mayor-icon" onerror="this.style.display='none'">
            <h1>å¸‚é•·ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</h1>
        </div>
        <div class="turn-badge" id="turn-display">YEAR 1 / 10</div>
    </header>

    <button class="bgm-btn" id="bgm-btn" onclick="toggleBGM()">ğŸ”Š</button>

    <div class="status-bar">
        <div class="stat-box">
            <div class="stat-label">ECONOMY</div>
            <div class="stat-label">ğŸ’° çµŒæ¸ˆ</div>
            <div id="stat-eco" class="stat-value">10</div>
        </div>
        <div class="stat-box">
            <div class="stat-label">NATURE</div>
            <div class="stat-label">ğŸŒ¿ è‡ªç„¶</div>
            <div id="stat-nature" class="stat-value">10</div>
        </div>
        <div class="stat-box">
            <div class="stat-label">CULTURE</div>
            <div class="stat-label">ğŸ¨ æ–‡åŒ–</div>
            <div id="stat-culture" class="stat-value">10</div>
        </div>
    </div>

    <div class="screen" id="log-screen">
        <p>ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•...</p>
        <p>æ–°å¸‚é•·ã®ç€ä»»ã‚’ç¢ºèªã—ã¾ã—ãŸã€‚</p>
        <p>ã“ã‚Œã‚ˆã‚Š10å¹´é–“ã®å¸‚æ”¿é‹å–¶ã‚’é–‹å§‹ã—ã¾ã™ã€‚</p>
    </div>

    <div class="controls" id="controls">
        </div>

    <div class="overlay" id="sns-overlay">
        <div class="sns-window">
            <div class="sns-header">ğŸ“± å¸‚æ°‘ã®ãƒˆãƒ¬ãƒ³ãƒ‰</div>
            <div class="sns-feed" id="sns-feed"></div>
            <button class="sns-close-btn" onclick="closeSnsAndProceed()">æ±ºå®šã—ã¦æ¬¡ã®å¹´ã¸ â–¶</button>
        </div>
    </div>
</div>

<div class="ending-modal" id="ending-modal">
    <div class="ending-content">
        <div class="ending-rank">FINAL RESULT</div>
        <h2 class="ending-title" id="ending-title">???</h2>
        <p id="ending-desc">...</p>
        <div style="margin-top:20px; font-size:0.9em; color:#666;" id="ending-stats-summary"></div>
        <button class="restart-btn" onclick="initGame()">RESTART</button>
    </div>
</div>

<script>
    /* * --- Audio System (æ–°è¦è¿½åŠ ) ---
     */
    // ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆã«åˆã‚ã›ã¦ãƒ‘ã‚¹ã‚’æŒ‡å®šï¼ˆåŒã˜éšå±¤ã«ã‚ã‚‹å ´åˆï¼‰
    const bgm = new Audio('Neon Reverie.mp3'); 
    bgm.loop = true;
    bgm.volume = 0.4; // éŸ³é‡ã¯æ§ãˆã‚ã«
    let isMuted = false;

    // ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œï¼ˆã‚¿ãƒƒãƒ—ï¼‰ã‚’ãƒˆãƒªã‚¬ãƒ¼ã«ã—ã¦å†ç”Ÿã‚’é–‹å§‹ã™ã‚‹é–¢æ•°
    function startGameWithAudio() {
        const overlay = document.getElementById('start-overlay');
        
        // å†ç”Ÿã‚’è©¦ã¿ã‚‹
        bgm.play().then(() => {
            console.log("BGMå†ç”ŸæˆåŠŸ");
        }).catch(error => {
            console.log("BGMå†ç”Ÿã‚¨ãƒ©ãƒ¼ï¼ˆäºˆæœŸã›ã¬ãƒ–ãƒ­ãƒƒã‚¯ï¼‰:", error);
        });

        // ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆæ¼”å‡º
        overlay.style.transition = 'opacity 0.5s';
        overlay.style.opacity = '0';
        setTimeout(() => {
            overlay.style.display = 'none';
        }, 500);

        // ã‚²ãƒ¼ãƒ åˆæœŸåŒ–ï¼ˆå†ãƒ­ãƒ¼ãƒ‰æ™‚ãªã©ã‚’è€ƒæ…®ã—ã¦å‘¼ã¶ï¼‰
        initGame();
    }

    function toggleBGM() {
        const btn = document.getElementById('bgm-btn');
        if (isMuted) {
            bgm.volume = 0.4;
            btn.innerText = "ğŸ”Š";
            isMuted = false;
        } else {
            bgm.volume = 0;
            btn.innerText = "ğŸ”‡";
            isMuted = true;
        }
    }

    /* * --- Game Logic (æ—¢å­˜ã‚³ãƒ¼ãƒ‰ç¶­æŒ) ---
     */

    let gameState = {
        turn: 1,
        maxTurns: 10,
        stats: { eco: 10, nature: 10, culture: 10 }
    };

    let pendingChoice = null;

    // ã‚¤ãƒ™ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿
    const events = [
        {
            id: 1,
            text: "é§…å‰ã®å¤§è¦æ¨¡å†é–‹ç™ºè¨ˆç”»ãŒæµ®ä¸Šã—ã¦ã„ã¾ã™ã€‚",
            news: "é§…å‰ä¸€ç­‰åœ°ã®å†é–‹ç™ºæ¡ˆã€ã¾ã‚‚ãªãæ±ºå®šã‹",
            choices: [
                {
                    label: "å·¨å¤§ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°ãƒ¢ãƒ¼ãƒ«å»ºè¨­",
                    tags: "çµŒæ¸ˆâ†‘ è‡ªç„¶â†“",
                    effect: { eco: 6, nature: -4, culture: 0 },
                    log: "å·¨å¤§ãƒ¢ãƒ¼ãƒ«å»ºè¨­ã«ã‚ˆã‚Šã€åœ°ä¾¡ãŒé«˜é¨°ã—ãŸã€‚",
                    voices: [
                        { name: "JK_Mika", text: "ã‚¿ã‚¹ãƒå…¥ã‚‹ã£ã¦ãƒã‚¸ï¼ï¼Ÿç¥ã™ãğŸ¥¤", icon: "ğŸ‘§" },
                        { name: "å•†åº—è¡—ä¼šé•·", text: "é»’èˆ¹æ¥è¥²ã ...æˆ‘ã€…ã®åº—ã¯ã©ã†ãªã‚‹ã€‚", icon: "ğŸ‘´" },
                        { name: "é‡é³¥è¦³å¯Ÿä¼š", text: "ã‚ã®æ£®ã¯æ¸¡ã‚Šé³¥ã®ä¼‘æ†©åœ°ã ã£ãŸã®ã«...", icon: "ğŸ¦" }
                    ]
                },
                {
                    label: "ç·‘åœ°å…¬åœ’ã¨å¸‚æ°‘åºƒå ´ã®æ•´å‚™",
                    tags: "è‡ªç„¶â†‘ çµŒæ¸ˆâ†“",
                    effect: { eco: -2, nature: 5, culture: 2 },
                    log: "ç·‘è±Šã‹ãªå…¬åœ’ãŒå¸‚æ°‘ã®ã‚ªã‚¢ã‚·ã‚¹ã¨ãªã£ãŸã€‚",
                    voices: [
                        { name: "å­è‚²ã¦ãƒãƒ", text: "å­ä¾›ã‚’éŠã°ã›ã‚‹å ´æ‰€ãŒæ¬²ã—ã‹ã£ãŸã®ï¼ğŸŒ¸", icon: "ğŸ‘©" },
                        { name: "ç¤¾ç•œ", text: "æ˜¼ä¼‘ã¿ã«èŠç”Ÿã§å¯ã‚Œã‚‹ã€‚æœ€é«˜ã€‚", icon: "ğŸ‘”" },
                        { name: "ä¸å‹•ç”£ç‹", text: "ä¸€ç­‰åœ°ã‚’å…¬åœ’ã«ã™ã‚‹ã¨ã¯ã€æ­£æ°—ã‹ï¼Ÿ", icon: "ğŸ’°" }
                    ]
                },
                {
                    label: "ç¾ä»£ç¾è¡“é¤¨ã¨åŠ‡å ´ã®å»ºè¨­",
                    tags: "æ–‡åŒ–â†‘ çµŒæ¸ˆâ†“",
                    effect: { eco: -1, nature: -1, culture: 6 },
                    log: "å‰è¡›çš„ãªç¾è¡“é¤¨ãŒã‚ªãƒ¼ãƒ—ãƒ³ã—è©±é¡Œã«ã€‚",
                    voices: [
                        { name: "ç¾å¤§ç”Ÿ", text: "ã‚„ã£ã¨ã“ã®è¡—ã«ã‚‚æ–‡åŒ–ã®é¢¨ãŒå¹ã„ãŸğŸ¨", icon: "ğŸ¨" },
                        { name: "è¦³å…‰å®¢", text: "æ˜ ãˆã‚¹ãƒãƒƒãƒˆç™ºè¦‹ï¼#CityArt", icon: "ğŸ“¸" },
                        { name: "ç´ç¨è€…", text: "ãã‚“ãªç®±ç‰©ã‚ˆã‚Šé“è·¯ç›´ã—ã¦ãã‚Œã‚ˆğŸ’¢", icon: "ğŸš—" }
                    ]
                }
            ]
        },
        {
            id: 2,
            text: "ã‚·ãƒªã‚³ãƒ³ãƒãƒ¬ãƒ¼ã‹ã‚‰ITä¼æ¥­ã®èª˜è‡´æ‰“è¨ºã€‚",
            news: "ä¸–ç•Œçš„ITä¼æ¥­ã€å½“å¸‚ã¸ã®é€²å‡ºã‚’æ¤œè¨ä¸­",
            choices: [
                {
                    label: "ç¨åˆ¶å„ªé‡ã§å…¨é¢èª˜è‡´ã™ã‚‹",
                    tags: "çµŒæ¸ˆâ†‘â†‘ æ–‡åŒ–â†“",
                    effect: { eco: 8, nature: -2, culture: -3 },
                    log: "ã‚¬ãƒ©ã‚¹å¼µã‚Šã®ãƒ“ãƒ«ç¾¤ãŒç©ºã‚’è¦†ã£ãŸã€‚",
                    voices: [
                        { name: "Tech_Bro", text: "ã“ã“ã‚’ç¬¬äºŒã®ã‚·ãƒªã‚³ãƒ³ãƒãƒ¬ãƒ¼ã«ã™ã‚‹ãœğŸš€", icon: "ğŸ’»" },
                        { name: "å¤å‚ä½æ°‘", text: "æ¨ªæ–‡å­—ã°ã‹ã‚Šã§ã€ã‚‚ã¯ã‚„åˆ¥ã®è¡—ã ...", icon: "ğŸ‘µ" },
                        { name: "æŠ•è³‡å®¶Z", text: "æ ªä¾¡çˆ†ä¸ŠãŒã‚Šï½— è²·ã„å ã‚æ­£è§£ã€‚", icon: "ğŸ“ˆ" }
                    ]
                },
                {
                    label: "ç’°å¢ƒé…æ…®å‹ã‚ªãƒ•ã‚£ã‚¹ã®ã¿è¨±å¯",
                    tags: "è‡ªç„¶â†‘ çµŒæ¸ˆâ†‘",
                    effect: { eco: 3, nature: 3, culture: 0 },
                    log: "æ£®ã¨èª¿å’Œã—ãŸã‚¨ã‚³ãªã‚ªãƒ•ã‚£ã‚¹ãŒå®Œæˆã€‚",
                    voices: [
                        { name: "LOHAS", text: "å±‹ä¸Šåº­åœ’ã®ã‚ã‚‹ã‚ªãƒ•ã‚£ã‚¹ã€ç´ æ•µã§ã™ã­ğŸŒ¿", icon: "ğŸ¥—" },
                        { name: "å¤–è³‡ç³»CEO", text: "è¦åˆ¶ãŒã†ã‚‹ã•ã„è¡—ã ãŒã€ãƒ–ãƒ©ãƒ³ãƒ‰ã«ã¯ãªã‚‹ã€‚", icon: "ğŸ•´ï¸" }
                    ]
                },
                {
                    label: "æ–­å›ºæ‹’å¦ã—ã€ä¼çµ±ã‚’å®ˆã‚‹",
                    tags: "æ–‡åŒ–â†‘ çµŒæ¸ˆâ†“",
                    effect: { eco: -3, nature: 1, culture: 7 },
                    log: "èª˜è‡´ã‚’æ–­ã‚Šã€é™ã‹ãªè¡—ä¸¦ã¿ã‚’å®ˆã£ãŸã€‚",
                    voices: [
                        { name: "é ‘å›ºè·äºº", text: "ã‚ˆããè¨€ã£ãŸï¼ãƒãƒ£ãƒ©ã„å¥´ã‚‰ã¯è¦ã‚‰ã‚“ã€‚", icon: "ğŸ”¨" },
                        { name: "å°±æ´»ç”Ÿ", text: "ãˆãƒ¼ã€åœ°å…ƒã§åƒã‘ã‚‹ãƒãƒ£ãƒ³ã‚¹ã ã£ãŸã®ã«ğŸ˜­", icon: "ğŸ“" }
                    ]
                }
            ]
        },
        {
            id: 3,
            text: "å¸‚æ°‘ãƒ•ã‚§ã‚¹ãƒ†ã‚£ãƒãƒ«ã€ä»Šå¹´ã®ãƒ¡ã‚¤ãƒ³ãƒ†ãƒ¼ãƒã¯ï¼Ÿ",
            news: "ä»Šå¹´ã®ãƒ•ã‚§ã‚¹é–‹å‚¬æ±ºå®šã€ãƒ†ãƒ¼ãƒé¸å®šã¸",
            choices: [
                {
                    label: "ãƒ‰ãƒ­ãƒ¼ãƒ³ï¼†ãƒ­ãƒœãƒƒãƒˆåšè¦§ä¼š",
                    tags: "çµŒæ¸ˆâ†‘",
                    effect: { eco: 5, nature: -1, culture: 1 },
                    log: "ç©ºã‚’ãƒ‰ãƒ­ãƒ¼ãƒ³ãŒåŸ‹ã‚å°½ãã—ãŸã€‚",
                    voices: [
                        { name: "ãƒ¡ã‚«å¥½ã", text: "æœªæ¥ã‚­ã‚¿ãƒ¼ï¼ãƒ‰ãƒ­ãƒ¼ãƒ³ãƒ¬ãƒ¼ã‚¹ç†±ã„ï¼", icon: "ğŸ¤–" },
                        { name: "çŒ«ã®é£¼ã„ä¸»", text: "ãƒ«ãƒ³ãƒãŒè„±èµ°ã—ã¦å¤§é¨’ãã ãƒ‹ãƒ£ğŸˆ", icon: "ğŸˆ" }
                    ]
                },
                {
                    label: "å¤§ãƒ•ãƒ©ãƒ¯ãƒ¼ã‚¬ãƒ¼ãƒ‡ãƒ³",
                    tags: "è‡ªç„¶â†‘",
                    effect: { eco: 1, nature: 5, culture: 1 },
                    log: "è¡—ä¸­ãŒèŠ±ã®é¦™ã‚Šã«åŒ…ã¾ã‚ŒãŸã€‚",
                    voices: [
                        { name: "ã‚¤ãƒ³ãƒ•ãƒ«ã‚¨ãƒ³ã‚µãƒ¼", text: "ãŠèŠ±ç•‘ã§è‡ªæ’®ã‚Šãªã†ğŸ’ #FlowerFes", icon: "ğŸ“±" },
                        { name: "èŠ±ç²‰ç—‡æ‚£è€…", text: "ãã—ã‚ƒã¿ãŒæ­¢ã¾ã‚‰ã‚“...å¸‚é•·ã‚’è¨´ãˆã‚‹ğŸ¤§", icon: "ğŸ˜·" }
                    ]
                },
                {
                    label: "æˆ¦å›½æ­¦è€…è¡Œåˆ—ãƒ‘ãƒ¬ãƒ¼ãƒ‰",
                    tags: "æ–‡åŒ–â†‘",
                    effect: { eco: 1, nature: 0, culture: 5 },
                    log: "ç”²å†‘å§¿ã®å¸‚æ°‘ãŒæ­´å²çµµå·»ã‚’å†ç¾ã€‚",
                    voices: [
                        { name: "æ­´å¥³", text: "å°Šã„...æ¨ã—ã®æ­¦å°†ã‚³ã‚¹æœ€é«˜ã™ã...", icon: "ğŸ˜" },
                        { name: "å­ä¾›", text: "é§ã®äººã“ã‚ã„ã‚ˆã€œæ³£", icon: "ğŸ‘¶" }
                    ]
                }
            ]
        },
        {
            id: 4,
            text: "å¸‚å†…ã‚’æµã‚Œã‚‹å·ã®æ°´è³ªæ±šæŸ“ãŒç™ºè¦šã€‚",
            news: "ã€ç·Šæ€¥ã€‘ãƒªãƒãƒ¼ã‚µã‚¤ãƒ‰ã‚¨ãƒªã‚¢ã§ç•°è‡­é¨’ã",
            choices: [
                {
                    label: "å·¥å ´æ’æ°´ã®è¦åˆ¶ã‚’å³ç½°åŒ–",
                    tags: "è‡ªç„¶â†‘ çµŒæ¸ˆâ†“",
                    effect: { eco: -5, nature: 7, culture: 0 },
                    log: "å·¥å ´ã¯æ’¤é€€ã—ãŸãŒã€æ¸…æµãŒæˆ»ã£ãŸã€‚",
                    voices: [
                        { name: "é‡£ã‚Šäºº", text: "ã‚„ã£ã¨å¹»ã®é­šãŒæˆ»ã£ã¦ããŸãï¼", icon: "ğŸ£" },
                        { name: "å·¥å ´é•·", text: "ã“ã‚“ãªå³ã—ã„åŸºæº–ã˜ã‚ƒã‚„ã£ã¦ã‚‰ã‚Œã‚“...å€’ç”£ã ã€‚", icon: "ğŸ­" }
                    ]
                },
                {
                    label: "ç¨é‡‘ã‚’æŠ•å…¥ã—æµ„åŒ–è£…ç½®ã‚’è¨­ç½®",
                    tags: "çµŒæ¸ˆâ†“ è‡ªç„¶â†‘",
                    effect: { eco: -3, nature: 4, culture: 0 },
                    log: "å·¨é¡ã®äºˆç®—ã‚’ä½¿ã„ã€æ°´è³ªã‚’æ”¹å–„ã—ãŸã€‚",
                    voices: [
                        { name: "ä¸»å©¦", text: "æ°´ã¯ç¶ºéº—ã«ãªã£ãŸã‘ã©ã€ã¾ãŸå¢—ç¨ï¼Ÿ", icon: "ğŸ‘›" },
                        { name: "å¸‚é•·ãƒ•ã‚¡ãƒ³", text: "è¿…é€Ÿãªå¯¾å¿œã•ã™ãŒã§ã™ï¼", icon: "ğŸ‘" }
                    ]
                },
                {
                    label: "çµŒæ¸ˆå„ªå…ˆã€è¦‹ã¦è¦‹ã¬ãµã‚Šã‚’ã™ã‚‹",
                    tags: "çµŒæ¸ˆâ†‘ è‡ªç„¶â†“â†“",
                    effect: { eco: 6, nature: -8, culture: 0 },
                    log: "å·ã¯ãƒ‰ãƒ–å·ã¨ãªã‚Šã€ç•°è‡­ã‚’æ”¾ã¡å§‹ã‚ãŸ...",
                    voices: [
                        { name: "è¿‘éš£ä½æ°‘", text: "å·ãŒè™¹è‰²ã«å…‰ã£ã¦ã‚‹ã‚“ã ã‘ã©...â˜ ï¸", icon: "ğŸ¤¢" },
                        { name: "é—‡åŒ»è€…", text: "æœ€è¿‘ã€å¤‰ãªå’³ã‚’ã™ã‚‹æ‚£è€…ãŒå¢—ãˆãŸã­ã‡ã€‚", icon: "ğŸ’Š" }
                    ]
                }
            ]
        },
        {
            id: 5,
            text: "ç¯‰100å¹´ã®èµ¤ãƒ¬ãƒ³ã‚¬å€‰åº«ã€å–ã‚Šå£Šã—ã‹ä¿å­˜ã‹ã€‚",
            news: "æ­´å²çš„å»ºé€ ç‰©ã®å‡¦é‡å·¡ã‚Šè­°è«–æ²¸é¨°",
            choices: [
                {
                    label: "å–ã‚Šå£Šã—ã¦ã‚¿ãƒ¯ãƒ¼ãƒãƒ³ã‚·ãƒ§ãƒ³å»ºè¨­",
                    tags: "çµŒæ¸ˆâ†‘ æ–‡åŒ–â†“",
                    effect: { eco: 6, nature: 0, culture: -6 },
                    log: "æ­´å²ã¯ç“¦ç¤«ã¨ãªã‚Šã€é«˜ç´šãƒãƒ³ã‚·ãƒ§ãƒ³ãŒå»ºã£ãŸã€‚",
                    voices: [
                        { name: "ã‚»ãƒ¬ãƒ–", text: "çœºæœ›æœ€é«˜ï¼é§…ç›´çµã§ä¾¿åˆ©ï¼", icon: "ğŸ™ï¸" },
                        { name: "æ­´å²å­¦ä¼š", text: "é‡è›®ãªè¡Œç‚ºã ã€‚æ­´å²ã®ç ´å£Šè€…ã‚ã€‚", icon: "ğŸ“œ" }
                    ]
                },
                {
                    label: "ãƒ¬ãƒˆãƒ­ãªã‚«ãƒ•ã‚§ãƒ»é›‘è²¨è¡—ã«æ”¹è£…",
                    tags: "æ–‡åŒ–â†‘ çµŒæ¸ˆâ†“",
                    effect: { eco: -2, nature: 0, culture: 7 },
                    log: "ãŠã—ã‚ƒã‚Œãªè¦³å…‰åœ°ã¨ã—ã¦å†ç”Ÿã—ãŸã€‚",
                    voices: [
                        { name: "ã‚«ãƒ•ã‚§å·¡ã‚Š", text: "ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­ãµã‚ãµã‚ğŸ¥", icon: "â˜•" },
                        { name: "æ˜ ç”»ç›£ç£", text: "ç´ æ™´ã‚‰ã—ã„ãƒ­ã‚±åœ°ã ã€‚æ¬¡å›ä½œã¯ã“ã“ã§ã€‚", icon: "ğŸ¬" }
                    ]
                },
                {
                    label: "ãã®ã¾ã¾æ”¾ç½®ã—ãƒ„ã‚¿æ¤ç‰©åœ’ã«ã™ã‚‹",
                    tags: "è‡ªç„¶â†‘ æ–‡åŒ–â†‘",
                    effect: { eco: -2, nature: 5, culture: 4 },
                    log: "å»ƒå¢Ÿç¾ãŒè©±é¡Œã®ãƒŸã‚¹ãƒ†ãƒªãƒ¼ã‚¹ãƒãƒƒãƒˆã«ã€‚",
                    voices: [
                        { name: "å»ƒå¢Ÿãƒãƒ‹ã‚¢", text: "ã“ã®æœ½ã¡æœã¦ã¦è‡ªç„¶ã«é‚„ã‚‹æ„Ÿã˜...ãŸã¾ã‚‰ã‚“ã€‚", icon: "ğŸ“·" },
                        { name: "è™«å«Œã„", text: "è™«ãŒå¢—ãˆã¦æœ€æ‚ªãªã‚“ã§ã™ã‘ã©ã€‚", icon: "ğŸ›" }
                    ]
                }
            ]
        }
    ];

    function initGame() {
        gameState.turn = 1;
        gameState.stats = { eco: 10, nature: 10, culture: 10 };
        document.getElementById('ending-modal').style.display = 'none';
        
        const screen = document.getElementById('log-screen');
        screen.innerHTML = '';
        log('ã‚·ã‚¹ãƒ†ãƒ ã‚ªãƒ¼ãƒ«ã‚°ãƒªãƒ¼ãƒ³ã€‚');
        log('å¸‚é•·ã®ç€ä»»ã‚’ç¢ºèªã€‚ã“ã‚Œã‚ˆã‚Šå¸‚æ”¿ã‚’é–‹å§‹ã—ã¾ã™ã€‚');

        updateUI();
        loadEvent();
    }

    function updateUI() {
        document.getElementById('turn-display').innerText = `YEAR ${gameState.turn} / ${gameState.maxTurns}`;
        
        document.getElementById('stat-eco').innerText = gameState.stats.eco;
        document.getElementById('stat-nature').innerText = gameState.stats.nature;
        document.getElementById('stat-culture').innerText = gameState.stats.culture;
    }

    function loadEvent() {
        const controlsDiv = document.getElementById('controls');
        controlsDiv.innerHTML = '';

        const eventIndex = (gameState.turn - 1) % events.length;
        const currentEvent = events[eventIndex];

        updateTicker(currentEvent.news);
        log(`\n[ ç¬¬${gameState.turn}å¹´ ] ${currentEvent.text}`);

        currentEvent.choices.forEach(choice => {
            const btn = document.createElement('button');
            btn.className = 'choice-btn';
            // ã‚¹ãƒãƒ›å‘ã‘ã«ã‚µãƒ–ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¹ãƒ‘ãƒ³ã§å›²ã‚“ã§ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°å¯èƒ½ã«
            btn.innerHTML = `${choice.label} <span class="btn-subtext">${choice.tags}</span>`;
            btn.onclick = () => openSns(choice);
            controlsDiv.appendChild(btn);
        });
    }

    function updateTicker(text) {
        const ticker = document.getElementById('news-ticker');
        ticker.innerText = `BREAKING NEWS: ${text}  ///  ç¾åœ¨ã®å¸‚æ³: çµŒæ¸ˆ${gameState.stats.eco} è‡ªç„¶${gameState.stats.nature} æ–‡åŒ–${gameState.stats.culture}  ///  `;
    }

    function openSns(choice) {
        pendingChoice = choice;
        const overlay = document.getElementById('sns-overlay');
        const feed = document.getElementById('sns-feed');
        feed.innerHTML = '';

        choice.voices.forEach(voice => {
            const tweet = document.createElement('div');
            tweet.className = 'tweet';
            const likes = Math.floor(Math.random() * 800) + 12;
            
            tweet.innerHTML = `
                <div class="avatar">${voice.icon}</div>
                <div class="tweet-content">
                    <div class="user-name">${voice.name}</div>
                    <div class="tweet-text">${voice.text}</div>
                    <div class="likes">â¤ï¸ ${likes} Likes</div>
                </div>
            `;
            feed.appendChild(tweet);
        });

        overlay.style.display = 'flex';
    }

    function closeSnsAndProceed() {
        document.getElementById('sns-overlay').style.display = 'none';
        if(pendingChoice) {
            executeChoice(pendingChoice);
        }
    }

    function executeChoice(choice) {
        gameState.stats.eco += choice.effect.eco;
        gameState.stats.nature += choice.effect.nature;
        gameState.stats.culture += choice.effect.culture;

        log(`> æ±ºå®š: ${choice.label}`);
        log(`> ${choice.log}`);

        gameState.turn++;

        if (gameState.turn > gameState.maxTurns) {
            updateUI();
            showEnding();
        } else {
            updateUI();
            loadEvent();
            scrollToBottom();
        }
    }

    function log(msg) {
        const screen = document.getElementById('log-screen');
        const p = document.createElement('p');
        p.innerText = msg;
        screen.appendChild(p);
        scrollToBottom();
    }

    function scrollToBottom() {
        const screen = document.getElementById('log-screen');
        screen.scrollTop = screen.scrollHeight;
    }

    function showEnding() {
        const modal = document.getElementById('ending-modal');
        const title = document.getElementById('ending-title');
        const desc = document.getElementById('ending-desc');
        const summary = document.getElementById('ending-stats-summary');

        const { eco, nature, culture } = gameState.stats;
        let resultTitle = "", resultDesc = "";

        if (eco > 30 && nature < 10) {
            resultTitle = "ğŸŒƒ ãƒã‚ªãƒ»ã‚µã‚¤ãƒãƒ¼ã‚·ãƒ†ã‚£";
            resultDesc = "ç©ºã‚’è¦†ã†æ‘©å¤©æ¥¼ã€é£›ã³äº¤ã†ãƒ‰ãƒ­ãƒ¼ãƒ³ã€‚çµŒæ¸ˆã¯é ‚ç‚¹ã«é”ã—ãŸãŒã€ç·‘ã¯å¤±ã‚ã‚ŒãŸä¸å¤œåŸã€‚";
        } else if (nature > 30 && eco < 15) {
            resultTitle = "ğŸŒ² è–ãªã‚‹æ£®ã®éƒ½å¸‚";
            resultDesc = "æ–‡æ˜ã¨æ£®ãŒå®Œå…¨ã«èåˆã—ãŸå§¿ã€‚çµŒæ¸ˆè¦æ¨¡ã¯å°ã•ã„ãŒã€åœ°ä¸Šã§æœ€ã‚‚ç¾ã—ã„æ¥½åœ’ã€‚";
        } else if (culture > 30) {
            resultTitle = "ğŸ­ åƒå¹´ã®éƒ½";
            resultDesc = "ä¸–ç•Œä¸­ã‹ã‚‰äººã€…ãŒè¨ªã‚Œã‚‹ã€èŠ¸è¡“ã¨æ­´å²ã®è–åœ°ã€‚ãã®é­…åŠ›ã¯æ°¸é ã«èªã‚Šç¶™ãŒã‚Œã‚‹ã€‚";
        } else if (eco > 20 && nature > 20 && culture > 20) {
            resultTitle = "ğŸ’ å¥‡è·¡ã®ãƒ¦ãƒ¼ãƒˆãƒ”ã‚¢";
            resultDesc = "å…¨ã¦ã®ãƒãƒ©ãƒ³ã‚¹ãŒé»„é‡‘æ¯”ã§ä¿ãŸã‚ŒãŸä¼èª¬ã®éƒ½å¸‚ã€‚æ•™ç§‘æ›¸ã«è¼‰ã‚‹ãƒ¬ãƒ™ãƒ«ã®å‰æ¥­ã§ã™ã€‚";
        } else if (eco < 5 && nature < 5 && culture < 5) {
            resultTitle = "ğŸ‘» é™ç•Œé›†è½ãƒ»ã‚´ãƒ¼ã‚¹ãƒˆã‚¿ã‚¦ãƒ³";
            resultDesc = "è¡—ã¯ç ´ç¶»ã—ã€èª°ã‚‚ã„ãªããªã£ãŸ...ã€‚å¸‚é•·ã€ã©ã“ã§é–“é•ãˆãŸã®ã§ã—ã‚‡ã†ã‹ã€‚";
        } else if (eco >= nature && eco >= culture) {
            resultTitle = "ğŸ¢ ãƒ¡ã‚¬ãƒ­ãƒãƒªã‚¹";
            resultDesc = "æ¨™æº–çš„ãªç™ºå±•ã‚’é‚ã’ãŸå¤§éƒ½å¸‚ã€‚ä¾¿åˆ©ã ãŒã€ã©ã“ã‹ç„¡æ©Ÿè³ªãªç©ºæ°—ãŒæ¼‚ã†ã€‚";
        } else if (nature >= eco && nature >= culture) {
            resultTitle = "ğŸ¡ ç”°åœ’éƒ½å¸‚";
            resultDesc = "è‡ªç„¶è±Šã‹ãªãƒ™ãƒƒãƒ‰ã‚¿ã‚¦ãƒ³ã€‚æ´¾æ‰‹ã•ã¯ãªã„ãŒã€ä½ç’°å¢ƒã¯æŠœç¾¤ã«è‰¯ã„ã€‚";
        } else {
            resultTitle = "ğŸ¨ åœ°æ–¹æ–‡åŒ–éƒ½å¸‚";
            resultDesc = "ç‹¬è‡ªã®æ–‡åŒ–ãŒæ ¹ä»˜ã„ãŸã€å‘³ã®ã‚ã‚‹è¡—ã€‚ã‚³ã‚¢ãªãƒ•ã‚¡ãƒ³ãŒå¤šã„ã€‚";
        }

        title.innerText = resultTitle;
        desc.innerText = resultDesc;
        summary.innerText = `æœ€çµ‚ã‚¹ã‚³ã‚¢: çµŒæ¸ˆ${eco} / è‡ªç„¶${nature} / æ–‡åŒ–${culture}`;
        
        modal.style.display = 'flex';
    }

    // ã‚²ãƒ¼ãƒ é–‹å§‹å‡¦ç†ã¯ã€ŒTAP TO STARTã€ãƒœã‚¿ãƒ³ã«å§”ã­ã‚‹ãŸã‚ã€ã“ã“ã§ã¯åˆæœŸåŒ–ã¯å‘¼ã°ãªã„ã§ãŠã
    // initGame(); 
</script>

</body>
</html>
